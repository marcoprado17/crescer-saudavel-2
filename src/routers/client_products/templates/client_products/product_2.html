{% extends "client_base/client_base.html" %}
{% block title %}
    {{ R.string.product }}
{% endblock %}
{% block content %}
    <div class="__client_products__ __product_2__">
        <div class="container">
            <div class="photo-catalog-price-buy-box-container">
                <div class="photo-catalog">
                    {% for img_src in data.images_src %}
                        {% if loop.index0 <= 3 %}
                            <img src="{{ img_src }}" alt="{{ R.string.product_image }}"/><br>
                        {% endif %}
                    {% endfor %}
                </div>
                <div class="main-photo">
                    <img src="{{ data.images_src[0] }}" alt="{{ R.string.product_image }}">
                </div>
                <div class="price-buy-box-col">
                    <div class="price-buy-box">
                        {% if data.product.has_discount %}
                            <p>
                            {{ R.string.discount_from }}{{ data.product.price_with_discount_as_string(include_rs=True) }}</p>
                            <p>{{ R.string.discount_to }}
                                <span class="price">{{ data.product.get_formatted_price(include_rs=True) }}</span></p>
                        {% else %}
                            <p><span class="price">{{ data.product.get_formatted_price(include_rs=True) }}</span></p>
                        {% endif %}
                        <hr>
                        <form class="add-to-cart" method="post"
                              action="{{ url_for('client_cart.add_to_cart', **{R.string.product_id_arg_name: data.product.id}) }}">
                            <div class="pull-left">
                                <div class="custom pull-left">
                                    <button
                                            onClick="var result = document.getElementById('qty'); var qty = result.value; if( !isNaN( qty )) result.value++;return false;"
                                            class="increase items-count" type="button"><i
                                            class="icon-plus"></i></button>
                                    <input type="text" name="qty" id="qty" maxlength="12"
                                           value="1" title="Quantity:"
                                           class="input-text qty">
                                    <button
                                            onClick="var result = document.getElementById('qty'); var qty = result.value; if( !isNaN( qty ) &amp;&amp; qty &gt; 0 ) result.value--;return false;"
                                            class="reduced items-count" type="button"><i
                                            class="icon-minus"></i></button>
                                </div>
                            </div>
                            {{ submit_form.csrf_token() }}
                            <button class="button buy-button" type="submit"
                                    title="{{ R.string.add_to_cart }}">{{ R.string.buy }}</button>
                        </form>
                        <img class="padlock" src="{{ url_for('static', filename='imgs/password.png') }}">{{ R.string.buy_100_percent_safe }}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block script %}
    <script>
        $(function () {
            $(".photo-catalog img").each(function () {
                $(this).click(function () {
                    $(".main-photo img").attr("src", $(this).attr("src"));
                });
            });
        });
        {##}
        {#        $("form.add-to-cart").each(function () {#}
        {#            var form = $(this);#}
        {#            form.submit(function (event) {#}
        {#                var qty = $("#qty").val();#}
        {#                if (qty == 0) {#}
        {#                    event.preventDefault();#}
        {#                    return false;#}
        {#                }#}
        {#                form.attr("action", form.attr("action") + "&{0}={1}".f("{{ R.string.amount_arg_name }}", qty));#}
        {#            });#}
        {#        });#}
    </script>
{% endblock %}